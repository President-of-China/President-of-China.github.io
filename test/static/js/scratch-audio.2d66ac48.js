(self.webpackChunk_lls_web_app=self.webpackChunk_lls_web_app||[]).push([[2125],{4445:(h,l,o)=>{const t=o(36888),n=o(35842),a=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767],s=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8];let e=null;const i=function(){if(e===null){const E=a.length,c=s.length;e=new Array(E*c).fill(0);let d=0;for(let g=0;g<E;g++)for(let r=0;r<c;r++){const y=a[g];let m=0;r&4&&(m+=y),r&2&&(m+=y>>1),r&1&&(m+=y>>2),m+=y>>3,e[d++]=r&8?-m:m}}return e};class p{constructor(c){this.audioContext=c}static get STEP_TABLE(){return a}static get INDEX_TABLE(){return s}decode(c){return new Promise((d,g)=>{const r=new t(c);r.readUint8String(4)!=="RIFF"&&(n.warn("incorrect adpcm wav header"),g());const m=r.readInt32();m+8!==c.byteLength&&n.warn(`adpcm wav length in header: ${m} is incorrect`),r.readUint8String(4)!=="WAVE"&&(n.warn("incorrect adpcm wav header"),g());const u=this.extractChunk("fmt ",r);this.encoding=u.readUint16(),this.channels=u.readUint16(),this.samplesPerSecond=u.readUint32(),this.bytesPerSecond=u.readUint32(),this.blockAlignment=u.readUint16(),this.bitsPerSample=u.readUint16(),u.position+=2,this.samplesPerBlock=u.readUint16(),this.adpcmBlockSize=(this.samplesPerBlock-1)/2+4;const P=this.extractChunk("data",r),_=this.numberOfSamples(P,this.adpcmBlockSize),A=this.audioContext.createBuffer(1,_,this.samplesPerSecond);this.imaDecompress(P,this.adpcmBlockSize,A.getChannelData(0)),d(A)})}extractChunk(c,d){for(d.position=12;d.position<d.getLength()-8;){const g=d.readUint8String(4),r=d.readInt32();if(g===c)return d.extract(r);d.position+=r}}numberOfSamples(c,d){if(!c)return 0;c.position=0;const g=c.getBytesAvailable(),y=(g/d|0)*(2*(d-4))+1,m=Math.max(g%d-4,0)*2,f=Math.min(g%d,1);return y+m+f}imaDecompress(c,d,g){let r,y,m,f=0,u=-1;if(!c)return;c.position=0;const P=g.length,_=(d-4)*2,A=i();let N=0;for(;N<P;){r=c.readInt16(),f=c.readUint8(),c.position++,f>88&&(f=88),g[N++]=r/32768;const S=Math.min(_,P-N),x=N;for(;N-x<S;)u=c.readUint8(),y=u&15,m=A[f*16+y],f+=s[y],f>88?f=88:f<0&&(f=0),r+=m,r>32767?r=32767:r<-32768&&(r=-32768),g[N++]=r/32768,y=u>>4&15,m=A[f*16+y],f+=s[y],f>88?f=88:f<0&&(f=0),r+=m,r>32767?r=32767:r<-32768&&(r=-32768),g[N++]=r/32768}}}h.exports=p},36888:h=>{class l{constructor(t,n=0,a=t.byteLength,{_uint8View:s=new Uint8Array(t)}={}){this.arrayBuffer=t,this.start=n,this.end=a,this._uint8View=s,this._position=n}extract(t){return new l(this.arrayBuffer,this._position,this._position+t,this)}getLength(){return this.end-this.start}getBytesAvailable(){return this.end-this._position}get position(){return this._position-this.start}set position(t){return this._position=t+this.start,t}readUint8(){const t=this._uint8View[this._position];return this._position+=1,t}readUint8String(t){const n=this._uint8View;let a="";const s=this._position+t;for(let e=this._position;e<s;e++)a+=String.fromCharCode(n[e]);return this._position+=t,a}readInt16(){const t=new Int16Array(this.arrayBuffer,this._position,1)[0];return this._position+=2,t}readUint16(){const t=new Uint16Array(this.arrayBuffer,this._position,1)[0];return this._position+=2,t}readInt32(){let t;return this._position%4===0?t=new Int32Array(this.arrayBuffer,this._position,1)[0]:t=new Int32Array(this.arrayBuffer.slice(this._position,this._position+4))[0],this._position+=4,t}readUint32(){const t=new Uint32Array(this.arrayBuffer,this._position,1)[0];return this._position+=4,t}}h.exports=l},47750:(h,l,o)=>{const t=o(23570),n=o(70528),a=o(35842),s=o(17684),e=o(4445),i=o(29416),p=o(61876),E=o(39396),c=o(3623),d=o(81090),g=o(19092),r=o(30290),y=function(f,u){return f.decodeAudioData.length===1?f.decodeAudioData(u):new Promise((P,_)=>{f.decodeAudioData(u,A=>P(A),A=>_(A))})};class m{constructor(u=new n){this.audioContext=u,t(this.audioContext),this.inputNode=this.audioContext.createGain(),this.inputNode.connect(this.audioContext.destination),this.audioBuffers={},this.loudness=null,this.effects=[c,d,g]}get currentTime(){return this.audioContext.currentTime}get EFFECT_NAMES(){return{pitch:"pitch",pan:"pan"}}get DECAY_DURATION(){return .025}get DECAY_WAIT(){return .05}getInputNode(){return this.inputNode}_decodeSound(u){const P=u.data.buffer.slice(0),_=s();return y(this.audioContext,P).catch(()=>{if(u.data.length===0)return this._emptySound();const N=u.data.buffer.slice(0);return new e(this.audioContext).decode(N).catch(()=>this._emptySound())}).then(N=>[_,N],N=>{a.warn("audio data could not be decoded",N)})}_emptySound(){return this.audioContext.createBuffer(1,1,this.audioContext.sampleRate)}decodeSound(u){return this._decodeSound(u).then(([P,_])=>(this.audioBuffers[P]=_,P))}decodeSoundPlayer(u){return this._decodeSound(u).then(([P,_])=>new p(this,{id:P,buffer:_}))}getLoudness(){return this.loudness||(this.loudness=new i(this.audioContext)),this.loudness.getLoudness()}createEffectChain(){const u=new E(this,this.effects);return u.connect(this),u}createBank(){return new r(this,this.createEffectChain())}}h.exports=m},29416:(h,l,o)=>{const t=o(35842);class n{constructor(s){this.audioContext=s,this.connectingToMic=!1,this.mic=null}getLoudness(){if(!this.mic&&!this.connectingToMic&&(this.connectingToMic=!0,navigator.mediaDevices.getUserMedia({audio:!0}).then(s=>{this.audioStream=s,this.mic=this.audioContext.createMediaStreamSource(s),this.analyser=this.audioContext.createAnalyser(),this.mic.connect(this.analyser),this.micDataArray=new Float32Array(this.analyser.fftSize)}).catch(s=>{t.warn(s)})),this.mic&&this.audioStream.active){this.analyser.getFloatTimeDomainData(this.micDataArray);let s=0;for(let i=0;i<this.micDataArray.length;i++)s+=Math.pow(this.micDataArray[i],2);let e=Math.sqrt(s/this.micDataArray.length);return this._lastValue&&(e=Math.max(e,this._lastValue*.6)),this._lastValue=e,e*=1.63,e=Math.sqrt(e),e=Math.round(e*100),e=Math.min(e,100),e}return-1}}h.exports=n},30290:(h,l,o)=>{const t=o(35842),n="*";class a{constructor(e,i){this.audioEngine=e,this.soundPlayers={},this.playerTargets=new Map,this.soundEffects=new Map,this.effectChainPrime=i}addSoundPlayer(e){this.soundPlayers[e.id]=e}getSoundPlayer(e){return this.soundPlayers[e]||t.error(`SoundBank.getSoundPlayer(${e}): called missing sound in bank`),this.soundPlayers[e]}getSoundEffects(e){return this.soundEffects.has(e)||this.soundEffects.set(e,this.effectChainPrime.clone()),this.soundEffects.get(e)}playSound(e,i){const p=this.getSoundEffects(i),E=this.getSoundPlayer(i);return this.playerTargets.get(i)!==e&&E.stop(),this.playerTargets.set(i,e),p.addSoundPlayer(E),p.setEffectsFromTarget(e),E.connect(p),E.play(),E.finished()}setEffects(e){this.playerTargets.forEach((i,p)=>{i===e&&this.getSoundEffects(p).setEffectsFromTarget(e)})}stop(e,i){this.playerTargets.get(i)===e&&this.soundPlayers[i].stop()}stopAllSounds(e=n){this.playerTargets.forEach((i,p)=>{(e===n||i===e)&&this.getSoundPlayer(p).stop()})}dispose(){this.playerTargets.clear(),this.soundEffects.forEach(e=>e.dispose()),this.soundEffects.clear();for(const e in this.soundPlayers)this.soundPlayers.hasOwnProperty(e)&&this.soundPlayers[e].dispose();this.soundPlayers={}}}h.exports=a},61876:(h,l,o)=>{const{EventEmitter:t}=o(22699),n=o(19092),a="ended";class s extends t{constructor(i,{id:p,buffer:E}){super();this.id=p,this.audioEngine=i,this.buffer=E,this.outputNode=null,this.volumeEffect=null,this.target=null,this.initialized=!1,this.isPlaying=!1,this.startingUntil=0,this.playbackRate=1,this.handleEvent=this.handleEvent.bind(this)}get isStarting(){return this.isPlaying&&this.startingUntil>this.audioEngine.currentTime}handleEvent(i){i.type===a&&this.onEnded()}onEnded(){this.emit("stop"),this.isPlaying=!1}_createSource(){this.outputNode!==null&&(this.outputNode.removeEventListener(a,this.handleEvent),this.outputNode.disconnect()),this.outputNode=this.audioEngine.audioContext.createBufferSource(),this.outputNode.playbackRate.value=this.playbackRate,this.outputNode.buffer=this.buffer,this.outputNode.addEventListener(a,this.handleEvent),this.target!==null&&this.connect(this.target)}initialize(){this.initialized=!0,this._createSource()}connect(i){if(i===this.volumeEffect){this.outputNode.disconnect(),this.outputNode.connect(this.volumeEffect.getInputNode());return}if(this.target=i,!!this.initialized)return this.volumeEffect===null?(this.outputNode.disconnect(),this.outputNode.connect(i.getInputNode())):this.volumeEffect.connect(i),this}dispose(){!this.initialized||(this.stopImmediately(),this.volumeEffect!==null&&(this.volumeEffect.dispose(),this.volumeEffect=null),this.outputNode.disconnect(),this.outputNode=null,this.target=null,this.initialized=!1)}take(){this.outputNode&&this.outputNode.removeEventListener(a,this.handleEvent);const i=new s(this.audioEngine,this);return i.playbackRate=this.playbackRate,this.isPlaying&&(i.startingUntil=this.startingUntil,i.isPlaying=this.isPlaying,i.initialized=this.initialized,i.outputNode=this.outputNode,i.outputNode.addEventListener(a,i.handleEvent),i.volumeEffect=this.volumeEffect,i.volumeEffect&&(i.volumeEffect.audioPlayer=i),this.target!==null&&i.connect(this.target),this.emit("stop"),i.emit("play")),this.outputNode=null,this.volumeEffect=null,this.initialized=!1,this.startingUntil=0,this.isPlaying=!1,i}play(){if(this.isStarting){this.emit("stop"),this.emit("play");return}this.isPlaying&&this.stop(),this.initialized?this._createSource():this.initialize(),this.outputNode.start(),this.isPlaying=!0;const{currentTime:i,DECAY_DURATION:p}=this.audioEngine;this.startingUntil=i+p,this.emit("play")}stop(){if(!this.isPlaying)return;const i=this.take();i.volumeEffect=new n(i.audioEngine,i,null),i.volumeEffect.connect(i.target),i.finished().then(()=>i.dispose()),i.volumeEffect.set(0);const{currentTime:p,DECAY_DURATION:E}=this.audioEngine;i.outputNode.stop(p+E)}stopImmediately(){!this.isPlaying||(this.outputNode.stop(),this.isPlaying=!1,this.startingUntil=0,this.emit("stop"))}finished(){return new Promise(i=>{this.once("stop",i)})}setPlaybackRate(i){this.playbackRate=i,this.initialized&&(this.outputNode.playbackRate.value=i)}}h.exports=s},23570:(h,l,o)=>{const t=o(47263);h.exports=function(n){if(typeof document!="undefined")return t(n)}},17994:h=>{class l{constructor(t,n,a){this.audioEngine=t,this.audioPlayer=n,this.lastEffect=a,this.value=this.DEFAULT_VALUE,this.initialized=!1,this.inputNode=null,this.outputNode=null,this.target=null}get name(){throw new Error(`${this.constructor.name}.name is not implemented`)}get DEFAULT_VALUE(){return 0}get _isPatch(){return this.initialized&&(this.value!==this.DEFAULT_VALUE||this.audioPlayer===null)}getInputNode(){return this._isPatch?this.inputNode:this.target.getInputNode()}initialize(){throw new Error(`${this.constructor.name}.initialize is not implemented.`)}_set(){throw new Error(`${this.constructor.name}._set is not implemented.`)}set(t){this.initialized||this.initialize();const n=this._isPatch;n&&(this._lastPatch=this.audioEngine.currentTime),this._set(t),this._isPatch!==n&&this.target!==null&&this.connect(this.target)}update(){}clear(){this.set(this.DEFAULT_VALUE)}connect(t){if(t===null)throw new Error("target may not be null");const n=a=>{if(a)return a===this?!0:n(a.target)};if(n(t))throw new Error("Effect cannot connect to itself");this.target=t,this.outputNode!==null&&this.outputNode.disconnect(),(this._isPatch||this._lastPatch+this.audioEngine.DECAY_DURATION<this.audioEngine.currentTime)&&this.outputNode.connect(t.getInputNode()),this.lastEffect===null?this.audioPlayer!==null&&this.audioPlayer.connect(this):this.lastEffect.connect(this)}dispose(){this.inputNode=null,this.outputNode=null,this.target=null,this.initialized=!1}}h.exports=l},39396:h=>{class l{constructor(t,n){this.audioEngine=t,this.inputNode=this.audioEngine.audioContext.createGain(),this.effects=n;let a=null;this._effects=n.reverse().map(s=>{const e=new s(t,this,a);return this[e.name]=e,a=e,e}).reverse(),this.firstEffect=this._effects[0],this.lastEffect=this._effects[this._effects.length-1],this._soundPlayers=new Set}clone(){const t=new l(this.audioEngine,this.effects);return this.target&&t.connect(this.target),t}addSoundPlayer(t){this._soundPlayers.has(t)||(this._soundPlayers.add(t),this.update())}removeSoundPlayer(t){this._soundPlayers.remove(t)}getInputNode(){return this.inputNode}connect(t){const{firstEffect:n,lastEffect:a}=this;if(t===a){this.inputNode.disconnect(),this.inputNode.connect(a.getInputNode());return}else if(t===n)return;this.target=t,n.connect(t)}getSoundPlayers(){return[...this._soundPlayers]}setEffectsFromTarget(t){this._effects.forEach(n=>{"soundEffects"in t&&n.name in t.soundEffects?n.set(t.soundEffects[n.name]):n.name in t&&n.set(t[n.name])})}set(t,n){t in this&&this[t].set(n)}update(){this._effects.forEach(t=>t.update())}clear(){this._effects.forEach(t=>t.clear())}dispose(){this._soundPlayers=null,this._effects.forEach(t=>t.dispose()),this._effects=null}}h.exports=l},3623:(h,l,o)=>{const t=o(17994);class n extends t{constructor(s,e,i){super(s,e,i);this.leftGain=null,this.rightGain=null,this.channelMerger=null}get name(){return"pan"}initialize(){const s=this.audioEngine.audioContext;this.inputNode=s.createGain(),this.leftGain=s.createGain(),this.rightGain=s.createGain(),this.channelMerger=s.createChannelMerger(2),this.outputNode=this.channelMerger,this.inputNode.connect(this.leftGain),this.inputNode.connect(this.rightGain),this.leftGain.connect(this.channelMerger,0,0),this.rightGain.connect(this.channelMerger,0,1),this.initialized=!0}_set(s){this.value=s;const e=(s+100)/200,i=Math.cos(e*Math.PI/2),p=Math.sin(e*Math.PI/2),{currentTime:E,DECAY_WAIT:c,DECAY_DURATION:d}=this.audioEngine;this.leftGain.gain.setTargetAtTime(i,E+c,d),this.rightGain.gain.setTargetAtTime(p,E+c,d)}dispose(){!this.initialized||(this.inputNode.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.channelMerger.disconnect(),this.inputNode=null,this.leftGain=null,this.rightGain=null,this.channelMerger=null,this.outputNode=null,this.target=null,this.initialized=!1)}}h.exports=n},81090:(h,l,o)=>{const t=o(17994);class n extends t{constructor(s,e,i){super(s,e,i);this.ratio=1}get name(){return"pitch"}get _isPatch(){return!1}getInputNode(){return this.target.getInputNode()}initialize(){this.initialized=!0}_set(s){this.value=s,this.ratio=this.getRatio(this.value),this.updatePlayers(this.audioPlayer.getSoundPlayers())}update(){this.updatePlayers(this.audioPlayer.getSoundPlayers())}getRatio(s){const e=s/10;return Math.pow(2,e/12)}updatePlayer(s){s.setPlaybackRate(this.ratio)}updatePlayers(s){if(!!s)for(const e in s)s.hasOwnProperty(e)&&this.updatePlayer(s[e])}}h.exports=n},19092:(h,l,o)=>{const t=o(17994);class n extends t{get DEFAULT_VALUE(){return 100}get name(){return"volume"}initialize(){this.inputNode=this.audioEngine.audioContext.createGain(),this.outputNode=this.inputNode,this.initialized=!0}_set(s){this.value=s;const{gain:e}=this.outputNode,{currentTime:i,DECAY_DURATION:p}=this.audioEngine;e.linearRampToValueAtTime(s/100,i+p)}dispose(){!this.initialized||(this.outputNode.disconnect(),this.inputNode=null,this.outputNode=null,this.target=null,this.initialized=!1)}}h.exports=n},93257:(h,l,o)=>{const t=o(47750);h.exports=t},35842:(h,l,o)=>{const t=o(27394);t.enable(),h.exports=t("scratch-audioengine")},17684:h=>{const l="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=function(){const t=20,n=l.length,a=[];for(let s=0;s<t;s++)a[s]=l.charAt(Math.random()*n);return a.join("")};h.exports=o}}]);
