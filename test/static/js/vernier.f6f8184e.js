(self.webpackChunk_lls_web_app=self.webpackChunk_lls_web_app||[]).push([[4494],{33323:function(H,Ne,ne){var I=ne(23716);(function(q,d){H.exports=d()})(this,function(){"use strict";function q(h,i,t,e,n,r,o){try{var l=h[r](o),u=l.value}catch(f){return void t(f)}l.done?i(u):Promise.resolve(u).then(e,n)}function d(h){return function(){var i=this,t=arguments;return new Promise(function(e,n){var r=h.apply(i,t);function o(u){q(r,e,n,o,l,"next",u)}function l(u){q(r,e,n,o,l,"throw",u)}o(void 0)})}}function M(h,i){if(!(h instanceof i))throw new TypeError("Cannot call a class as a function")}function re(h,i){for(var t=0;t<i.length;t++){var e=i[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(h,e.key,e)}}function F(h,i,t){return i&&re(h.prototype,i),t&&re(h,t),h}function ie(h,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");h.prototype=Object.create(i&&i.prototype,{constructor:{value:h,writable:!0,configurable:!0}}),i&&ae(h,i)}function K(h){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)})(h)}function ae(h,i){return(ae=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(h,i)}function oe(h,i){return!i||typeof i!="object"&&typeof i!="function"?function(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(h):i}(function(h){var i,t=Object.prototype,e=t.hasOwnProperty,n=typeof Symbol=="function"?Symbol:{},r=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",l=n.toStringTag||"@@toStringTag",u=!0,f=h.regeneratorRuntime;if(f)u&&(H.exports=f);else{(f=h.regeneratorRuntime=u?H.exports:{}).wrap=ce;var w="suspendedStart",g="suspendedYield",A="executing",x="completed",b={},L={};L[r]=function(){return this};var z=Object.getPrototypeOf,W=z&&z(z(te([])));W&&W!==t&&e.call(W,r)&&(L=W);var P=T.prototype=Z.prototype=Object.create(L);Q.prototype=P.constructor=T,T.constructor=Q,T[l]=Q.displayName="GeneratorFunction",f.isGeneratorFunction=function(s){var a=typeof s=="function"&&s.constructor;return!!a&&(a===Q||(a.displayName||a.name)==="GeneratorFunction")},f.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,T):(s.__proto__=T,l in s||(s[l]="GeneratorFunction")),s.prototype=Object.create(P),s},f.awrap=function(s){return{__await:s}},fe(B.prototype),B.prototype[o]=function(){return this},f.AsyncIterator=B,f.async=function(s,a,p,m){var c=new B(ce(s,a,p,m));return f.isGeneratorFunction(a)?c:c.next().then(function(_){return _.done?_.value:c.next()})},fe(P),P[l]="Generator",P[r]=function(){return this},P.toString=function(){return"[object Generator]"},f.keys=function(s){var a=[];for(var p in s)a.push(p);return a.reverse(),function m(){for(;a.length;){var c=a.pop();if(c in s)return m.value=c,m.done=!1,m}return m.done=!0,m}},f.values=te,ee.prototype={constructor:ee,reset:function(s){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach($),!s)for(var a in this)a.charAt(0)==="t"&&e.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=i)},stop:function(){this.done=!0;var s=this.tryEntries[0].completion;if(s.type==="throw")throw s.arg;return this.rval},dispatchException:function(s){if(this.done)throw s;var a=this;function p(G,v){return _.type="throw",_.arg=s,a.next=G,v&&(a.method="next",a.arg=i),!!v}for(var m=this.tryEntries.length-1;m>=0;--m){var c=this.tryEntries[m],_=c.completion;if(c.tryLoc==="root")return p("end");if(c.tryLoc<=this.prev){var N=e.call(c,"catchLoc"),U=e.call(c,"finallyLoc");if(N&&U){if(this.prev<c.catchLoc)return p(c.catchLoc,!0);if(this.prev<c.finallyLoc)return p(c.finallyLoc)}else if(N){if(this.prev<c.catchLoc)return p(c.catchLoc,!0)}else{if(!U)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return p(c.finallyLoc)}}}},abrupt:function(s,a){for(var p=this.tryEntries.length-1;p>=0;--p){var m=this.tryEntries[p];if(m.tryLoc<=this.prev&&e.call(m,"finallyLoc")&&this.prev<m.finallyLoc){var c=m;break}}c&&(s==="break"||s==="continue")&&c.tryLoc<=a&&a<=c.finallyLoc&&(c=null);var _=c?c.completion:{};return _.type=s,_.arg=a,c?(this.method="next",this.next=c.finallyLoc,b):this.complete(_)},complete:function(s,a){if(s.type==="throw")throw s.arg;return s.type==="break"||s.type==="continue"?this.next=s.arg:s.type==="return"?(this.rval=this.arg=s.arg,this.method="return",this.next="end"):s.type==="normal"&&a&&(this.next=a),b},finish:function(s){for(var a=this.tryEntries.length-1;a>=0;--a){var p=this.tryEntries[a];if(p.finallyLoc===s)return this.complete(p.completion,p.afterLoc),$(p),b}},catch:function(s){for(var a=this.tryEntries.length-1;a>=0;--a){var p=this.tryEntries[a];if(p.tryLoc===s){var m=p.completion;if(m.type==="throw"){var c=m.arg;$(p)}return c}}throw new Error("illegal catch attempt")},delegateYield:function(s,a,p){return this.delegate={iterator:te(s),resultName:a,nextLoc:p},this.method==="next"&&(this.arg=i),b}}}function ce(s,a,p,m){var c=a&&a.prototype instanceof Z?a:Z,_=Object.create(c.prototype),N=new ee(m||[]);return _._invoke=function(U,G,v){var S=w;return function(C,O){if(S===A)throw new Error("Generator is already running");if(S===x){if(C==="throw")throw O;return le()}for(v.method=C,v.arg=O;;){var D=v.delegate;if(D){var R=he(D,v);if(R){if(R===b)continue;return R}}if(v.method==="next")v.sent=v._sent=v.arg;else if(v.method==="throw"){if(S===w)throw S=x,v.arg;v.dispatchException(v.arg)}else v.method==="return"&&v.abrupt("return",v.arg);S=A;var E=J(U,G,v);if(E.type==="normal"){if(S=v.done?x:g,E.arg===b)continue;return{value:E.arg,done:v.done}}E.type==="throw"&&(S=x,v.method="throw",v.arg=E.arg)}}}(s,p,N),_}function J(s,a,p){try{return{type:"normal",arg:s.call(a,p)}}catch(m){return{type:"throw",arg:m}}}function Z(){}function Q(){}function T(){}function fe(s){["next","throw","return"].forEach(function(a){s[a]=function(p){return this._invoke(a,p)}})}function B(s){var a;this._invoke=function(p,m){function c(){return new Promise(function(_,N){(function U(G,v,S,C){var O=J(s[G],s,v);if(O.type!=="throw"){var D=O.arg,R=D.value;return R&&typeof R=="object"&&e.call(R,"__await")?Promise.resolve(R.__await).then(function(E){U("next",E,S,C)},function(E){U("throw",E,S,C)}):Promise.resolve(R).then(function(E){D.value=E,S(D)},function(E){return U("throw",E,S,C)})}C(O.arg)})(p,m,_,N)})}return a=a?a.then(c,c):c()}}function he(s,a){var p=s.iterator[a.method];if(p===i){if(a.delegate=null,a.method==="throw"){if(s.iterator.return&&(a.method="return",a.arg=i,he(s,a),a.method==="throw"))return b;a.method="throw",a.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var m=J(p,s.iterator,a.arg);if(m.type==="throw")return a.method="throw",a.arg=m.arg,a.delegate=null,b;var c=m.arg;return c?c.done?(a[s.resultName]=c.value,a.next=s.nextLoc,a.method!=="return"&&(a.method="next",a.arg=i),a.delegate=null,b):c:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,b)}function Te(s){var a={tryLoc:s[0]};1 in s&&(a.catchLoc=s[1]),2 in s&&(a.finallyLoc=s[2],a.afterLoc=s[3]),this.tryEntries.push(a)}function $(s){var a=s.completion||{};a.type="normal",delete a.arg,s.completion=a}function ee(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(Te,this),this.reset(!0)}function te(s){if(s){var a=s[r];if(a)return a.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length)){var p=-1,m=function c(){for(;++p<s.length;)if(e.call(s,p))return c.value=s[p],c.done=!1,c;return c.value=i,c.done=!0,c};return m.next=m}}return{next:le}}function le(){return{value:i,done:!0}}})(function(){return this||typeof self=="object"&&self}()||Function("return this")());var pe=new Uint8Array([88,0,0,0]),me=new Uint8Array([26,165,74,6,73,7,72,8,71,9,70,10,69,11,68,12,67,13,66,14,65]),ve=new Uint8Array([24,255,1,0,0,0,0,0,0,0,0,0,0,0,0]),ge=new Uint8Array([25,255,0,255,255,255,255]),de=new Uint8Array([27,255,0,0,0,0,0,0,0,0,0]),k={HEADER:pe,INIT:me,DISCONNECT:new Uint8Array([84]),START_MEASUREMENTS:ve,STOP_MEASUREMENTS:ge,SET_MEASUREMENT_PERIOD:de,GET_INFO:new Uint8Array([85]),GET_STATUS:new Uint8Array([16]),GET_SENSOR_IDS:new Uint8Array([81]),GET_SENSOR_INFO:new Uint8Array([80,0]),GET_DEFAULT_SENSORS_MASK:new Uint8Array([86])},ye=6,be=7,we=10,_e=8,ke=9,xe=11,Ee=12,Se=13,Re=14,Ue=32,j=function(h){return h!==0},se=function(){function h(){M(this,h),this._listenerMap=new Map}return F(h,[{key:"on",value:function(i,t){this._listenerMap.has(i)||this._listenerMap.set(i,[]),this._listenerMap.get(i).push(t)}},{key:"off",value:function(i,t){var e=this._listenerMap.get(i);if(e&&e.length){var n=e.reduce(function(r,o,l){return typeof o=="function"&&o===t?r=l:r},-1);if(n>-1)return e.splice(n,1),this._listenerMap.set(i,e),!0}return!1}},{key:"unbind",value:function(){this._listenerMap.clear()}},{key:"emit",value:function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];var r=this._listenerMap.get(i);return!(!r||!r.length)&&(r.forEach(function(o){o.apply(void 0,e)}),!0)}}]),h}(),y=function(){},Y=function(){};function X(h){return Array.from(new Uint8Array(h)).map(function(i){return i.toString(16).padStart(2,"0")}).join(" ")}var V,Ce=function h(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};M(this,h),this.type=i.type,this.mode=i.mode,this.minValue=i.minValue,this.maxValue=i.maxValue,this.uncertainty=i.uncertainty,this.minPeriod=i.minPeriod,this.maxPeriod=i.maxPeriod,this.typicalPeriod=i.typicalPeriod,this.granularity=i.granularity},Me=function h(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};M(this,h),this.number=i.number,this.name=i.name,this.unit=i.unit,this.id=i.id,this.mutalExclusionMask=i.mutalExclusionMask,this.measurementInfo=i.measurementInfo},Ae=function(h){function i(t){var e;return M(this,i),(e=oe(this,K(i).call(this))).number=t.number,e.name=t.name,e.unit=t.unit,e.specs=t,e.enabled=!1,e.values=[],e.value=null,e}return ie(i,se),F(i,[{key:"clear",value:function(){this.value=null,this.values=[]}},{key:"setValue",value:function(t,e){this.value=t,e&&this.values.push(this.value),this.emit("value-changed",this)}},{key:"setEnabled",value:function(t){this.enabled!==t&&(this.enabled=t,this.emit("state-changed",this))}}]),i}(),Le=function(h){function i(t){var e;if(M(this,i),e=oe(this,K(i).call(this)),typeof TextDecoder=="undefined"){var n=ne(52087);V=n.TextDecoder}else V=TextDecoder;return e.device=t,e.sensors=[],e.opened=!1,e.rollingCounter=0,e.collecting=!1,e.measurementPeriod=10,e.response=null,e.remainingResponseLength=0,e.defaultSensorsMask=0,e.keepValues=!0,e.minMeasurementPeriod=10,e.serialNumber="",e.orderCode="",e.name="",e}return ie(i,se),F(i,[{key:"getBatteryLevel",value:function(){var t=d(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._getStatus();case 2:return n=r.sent,r.abrupt("return",n.battery);case 4:case"end":return r.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"getChargingState",value:function(){var t=d(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._getStatus();case 2:return n=r.sent,r.abrupt("return",n.chargingStatus);case 4:case"end":return r.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"open",value:function(){var t=d(regeneratorRuntime.mark(function e(){var n,r=arguments;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return n=r.length>0&&r[0]!==void 0&&r[0],o.prev=1,o.next=4,this._connect();case 4:return o.next=6,this._init();case 6:return o.next=8,this._getStatus();case 8:return o.next=10,this._getDeviceInfo();case 10:return o.next=12,this._getDefaultSensorsMask();case 12:return o.next=14,this._getAvailableSensors();case 14:this._onOpened(),n&&this.start(),o.next=21;break;case 18:o.prev=18,o.t0=o.catch(1),I.error(o.t0);case 21:case"end":return o.stop()}},e,this,[[1,18]])}));return function(){return t.apply(this,arguments)}}()},{key:"close",value:function(){var t=d(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this._stopMeasurements();case 2:return n.next=4,this._sendCommand(k.DISCONNECT);case 4:return n.abrupt("return",this._disconnect());case 5:case"end":return n.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"enableDefaultSensors",value:function(){for(var t=1,e=0;e<32;++e){if((this.defaultSensorsMask&t)===t){var n=this.getSensor(e);n&&n.setEnabled(!0)}t<<=1}}},{key:"start",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=this.sensors.filter(function(n){return n.enabled});e.length===0&&(this.enableDefaultSensors(),e=this.sensors.filter(function(n){return n.enabled})),e.forEach(function(n){return n.clear()}),t&&(this.measurementPeriod=t),this._startMeasurements()}},{key:"stop",value:function(){this._stopMeasurements()}},{key:"getSensor",value:function(t){return this.sensors.find(function(e){return e.number===t})}},{key:"_connect",value:function(){var t=d(regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.device.setup({onClosed:function(){return n._onClosed()},onResponse:function(o){return n._handleResponse(o)}}));case 1:case"end":return r.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"_disconnect",value:function(){var t=d(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.device.close());case 1:case"end":return n.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"_init",value:function(){return this.collecting=!1,this.rollingCounter=255,this.writeQueue=[],this._sendCommand(k.INIT)}},{key:"_handleResponse",value:function(t){if(y("command notified: ".concat(X(t.buffer))),this.remainingResponseLegnth>0){if(this.remainingResponseLegnth-=t.buffer.byteLength,this.response=new DataView((e=this.response.buffer,n=t.buffer.slice(0),(r=new Uint8Array(e.byteLength+n.byteLength)).set(new Uint8Array(e),0),r.set(new Uint8Array(n),e.byteLength),r.buffer)),this.remainingResponseLegnth>0)return}else this.response=t;var e,n,r,o=this.response.getUint8(1);if(o>this.response.buffer.byteLength)this.remainingResponseLegnth=o-this.response.buffer.byteLength;else switch(y("handle command: ".concat(X(this.response.buffer))),this.response.getUint8(0)){case Ue:this._processMeasurements(this.response);break;default:var l=this.response.getUint8(4),u=this.response.getUint8(5),f=new DataView(this.response.buffer,6);this._resolveWriteCommand(l,u,f),this.remainingResponseLegnth=0,this.response=null}}},{key:"_getSensorsWithMask",value:function(t){for(var e=[],n=1,r=0;r<32;++r){if((t&n)===n){var o=this.getSensor(r);o&&(e.push(o),y("available: [".concat(t,"] ").concat(e[e.length-1].number)))}n<<=1}return e}},{key:"_processMeasurements",value:function(t){var e=[],n=!0,r=0,o=0,l=t.getUint8(4);switch(l){case ye:e=this._getSensorsWithMask(t.getUint16(5,!0)),r=t.getUint8(7,!0),o=9;break;case be:e=this._getSensorsWithMask(t.getUint32(5,!0)),r=t.getUint8(9,!0),o=11;break;case we:case _e:e[0]=this.getSensor(t.getUint8(6)),r=t.getUint8(7,!0),o=8;break;case xe:case ke:e[0]=this.getSensor(t.getUint8(6)),r=t.getUint8(7,!0),o=8,n=!1;break;case Ee:case Se:case Re:y("Purposely Ignoring packet type: ".concat(l));break;default:y("Unknown packet type: ".concat(l))}for(var u=0;u<r;++u)for(var f=0;f<e.length;++f)n?e[f].setValue(t.getFloat32(o,!0),this.keepValues):e[f].setValue(t.getInt32(o,!0),this.keepValues),o+=4}},{key:"_resolveWriteCommand",value:function(t,e,n){var r=this.writeQueue.find(function(o){return o.command===t&&o.rollingCounter===e});r&&(r.resolve(n),this.writeQueue=this.writeQueue.filter(function(o){return o!==r}))}},{key:"_onOpened",value:function(){y("opened"),this.opened=!0,this.emit("device-opened")}},{key:"_onClosed",value:function(){y("closed"),this.opened=!1,this.emit("device-closed")}},{key:"_decRollingCounter",value:function(){return this.rollingCounter-=1,this.rollingCounter}},{key:"_calculateChecksum",value:function(t){for(var e=t[1],n=-1*t[3],r=0;r<e;++r)n+=t[r],n&=255;return n<0||n>255?(y("Checksum failed!"),0):n}},{key:"_sendCommand",value:function(t){var e=new Uint8Array(k.HEADER.byteLength+t.byteLength);return e.set(new Uint8Array(k.HEADER),0),e.set(new Uint8Array(t),k.HEADER.byteLength),e[1]=e.length,e[2]=this._decRollingCounter(),e[3]=this._calculateChecksum(e),this._queueWriteCommand(e,0,e.length)}},{key:"_writeCommand",value:function(){var t=d(regeneratorRuntime.mark(function e(n,r,o){var l;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(o>0)){u.next=12;break}return u.prev=1,o>20?(l=n.subarray(r,r+20),o-=20,r+=20):(l=n.subarray(r,r+o),o=0),u.next=5,this.device.writeCommand(l);case 5:u.next=10;break;case 7:u.prev=7,u.t0=u.catch(1),y("Write Failure: ".concat(u.t0));case 10:u.next=0;break;case 12:case"end":return u.stop()}},e,this,[[1,7]])}));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_queueWriteCommand",value:function(t,e,n){var r=this;y("command queued: ".concat(X(t)));var o=new Promise(function(l,u){r.writeQueue.push({command:t[4],rollingCounter:t[2],resolve:l,reject:u}),setTimeout(function(){r.writeQueue=r.writeQueue.filter(function(f){return f.command===t[4]&&f.rollingCounter!==t[2]}),u(new Error("write command timed out after 5s. Command: ".concat(t[4].toString(16)," Rolling Counter: ").concat(t[2].toString(16))))},1e4)});return this._writeCommand(t,e,n),o}},{key:"_getStatus",value:function(){var t=d(regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this._sendCommand(k.GET_STATUS);case 2:return n=o.sent,r={masterFirmwareVersion:"".concat(n.getUint8(2),".").concat(n.getUint8(3)),bleFirmwareVersion:"".concat(n.getUint8(6),".").concat(n.getUint8(9)),battery:n.getUint8(10),chargingStatus:"".concat(n.getUint8(11))},o.abrupt("return",r);case 5:case"end":return o.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"_getAvailableSensors",value:function(){var t=d(regeneratorRuntime.mark(function e(){var n,r,o=this;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._sendCommand(k.GET_SENSOR_IDS).then(function(u){o.availableSensors=u.getUint32(0,!0),y("Get Available Sensors Returned ".concat(o.availableSensors))});case 2:n=1,r=0;case 4:if(!(r<31)){l.next=12;break}if((this.availableSensors&n)!==n){l.next=8;break}return l.next=8,this._getSensorInfo(r);case 8:n<<=1;case 9:++r,l.next=4;break;case 12:case"end":return l.stop()}},e,this)}));return function(){return t.apply(this,arguments)}}()},{key:"_getDefaultSensorsMask",value:function(){var t=this;return this._sendCommand(k.GET_DEFAULT_SENSORS_MASK).then(function(e){t.defaultSensorsMask=e.getUint32(0,!0),y("Default Sensors:"),Y(t)})}},{key:"_getDeviceInfo",value:function(){var t=this;return this._sendCommand(k.GET_INFO).then(function(e){var n=new V("utf-8");t.orderCode=n.decode(new Uint8Array(e.buffer,6,16).filter(j)),t.serialNumber=n.decode(new Uint8Array(e.buffer,22,16).filter(j)),t.name=n.decode(new Uint8Array(e.buffer,38,32).filter(j)),y("Device Info:"),Y(t)})}},{key:"_getSensorInfo",value:function(){var t=d(regeneratorRuntime.mark(function e(n){var r,o=this;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return(r=new Uint8Array(k.GET_SENSOR_INFO))[1]=n,l.abrupt("return",this._sendCommand(r).then(function(u){var f=u.getUint32(2,!0);if(f>0){var w=new V("utf-8"),g=new Ce({type:u.getUint8(6),mode:u.getUint8(7),minValue:u.getFloat64(108,!0),maxValue:u.getFloat64(116,!0),uncertainty:u.getFloat64(100,!0),minPeriod:u.getUint32(124,!0)/1e3,maxPeriod:((u.getUint32(132,!0)<<32)+u.getUint32(128,!0))/1e3,typicalPeriod:u.getUint32(136,!0)/1e3,granularity:u.getUint32(140,!0)/1e3}),A=new Me({number:u.getUint8(0),name:w.decode(new Uint8Array(u.buffer,14,60).filter(j)),unit:w.decode(new Uint8Array(u.buffer,74,32).filter(j)),mutalExclusiveMask:u.getUint32(144,!0),measurementInfo:g,sensorId:f}),x=new Ae(A);y("Get Sensor Info Returned"),Y(x),o.sensors.push(x),x.on("state-changed",function(){y("Sensor Restart: ".concat(x.number)),x.enabled&&(o.measurementPeriod=x.specs.measurementInfo.typicalPeriod,o.sensors.forEach(function(b){if(x.number!==b.number&&b.enabled){var L=1<<b.number;(L&x.specs.mutalExclusiveMask)===L?b.enabled=!1:b.specs.measurementInfo.typicalPeriod>o.measurementPeriod&&(o.measurementPeriod=b.specs.measurementInfo.typicalPeriod)}})),o._restartMeasurements()})}}));case 3:case"end":return l.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"_restartMeasurements",value:function(){var t=d(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=this.collecting,!this.collecting){r.next=10;break}return r.prev=2,r.next=5,this._stopMeasurements();case 5:r.next=10;break;case 7:r.prev=7,r.t0=r.catch(2),I.error(r.t0);case 10:if(this.collecting||!n){r.next=19;break}return r.prev=11,r.next=14,this._startMeasurements();case 14:r.next=19;break;case 16:r.prev=16,r.t1=r.catch(11),I.error(r.t1);case 19:case"end":return r.stop()}},e,this,[[2,7],[11,16]])}));return function(){return t.apply(this,arguments)}}()},{key:"_setMeasurementPeriod",value:function(t){var e=new Uint8Array(k.SET_MEASUREMENT_PERIOD),n=1e3*this.minMeasurementPeriod;return t<n&&(t=n),y("MeasurementPeriod: ".concat(t)),e[3]=t>>0&255,e[4]=t>>8&255,e[5]=t>>16&255,e[6]=t>>24&255,this._sendCommand(e)}},{key:"_getEnabledChannelMask",value:function(){var t=0;return this.sensors.filter(function(e){return e.enabled}).forEach(function(e){t+=1<<e.number}),t}},{key:"_startMeasurements",value:function(){var t=this;return this._setMeasurementPeriod(1e3*this.measurementPeriod).then(function(){var e=t._getEnabledChannelMask();y("ChannelMask: ".concat(e));var n=new Uint8Array(k.START_MEASUREMENTS);return n[3]=e>>0&255,n[4]=e>>8&255,n[5]=e>>16&255,n[6]=e>>24&255,t._sendCommand(n).then(function(r){r.getUint8(0)===0&&(t.collecting=!0,t.emit("measurements-started"))})})}},{key:"_stopMeasurements",value:function(){var t=this;return this._sendCommand(k.STOP_MEASUREMENTS).then(function(e){e.getUint8(0)===0&&(t.collecting=!1,t.emit("measurements-stopped"))})}}]),i}(),Pe=function(){function h(i){M(this,h),this.webBluetoothNativeDevice=i,this.deviceCommand=null,this.deviceResponse=null}return F(h,[{key:"writeCommand",value:function(){var i=d(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.deviceCommand.writeValue(e));case 1:case"end":return n.stop()}},t,this)}));return function(t){return i.apply(this,arguments)}}()},{key:"setup",value:function(){var i=d(regeneratorRuntime.mark(function t(e){var n,r,o,l,u=this;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return n=e.onClosed,r=e.onResponse,this.webBluetoothNativeDevice.addEventListener("gattserverdisconnected",n),f.prev=2,f.next=5,this.webBluetoothNativeDevice.gatt.connect();case 5:return o=f.sent,f.next=8,o.getPrimaryService("d91714ef-28b9-4f91-ba16-f0d9a604f112");case 8:return l=f.sent,f.next=11,l.getCharacteristics();case 11:f.sent.forEach(function(w){switch(w.uuid){case"f4bf14a6-c7d5-4b6d-8aa8-df1a7c83adcb":u.deviceCommand=w;break;case"b41e6675-a329-40e0-aa01-44d2f444babe":u.deviceResponse=w,u.deviceResponse.addEventListener("characteristicvaluechanged",function(g){var A=g.target.value;r(A)}),u.deviceResponse.startNotifications();break;default:y("No case found for ".concat(w.uuid))}}),f.next=18;break;case 15:f.prev=15,f.t0=f.catch(2),I.error(f.t0);case 18:if(this.deviceCommand&&this.deviceResponse){f.next=20;break}throw new Error("Expected command and response characteristics not found.");case 20:case"end":return f.stop()}},t,this,[[2,15]])}));return function(t){return i.apply(this,arguments)}}()},{key:"close",value:function(){var i=d(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.webBluetoothNativeDevice.gatt.disconnect());case 1:case"end":return e.stop()}},t,this)}));return function(){return i.apply(this,arguments)}}()},{key:"godirectAdapter",get:function(){return!0}}]),h}(),ue={createDevice:function(){var h=d(regeneratorRuntime.mark(function i(t){var e,n,r,o,l,u,f,w=arguments;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(e=w.length>1&&w[1]!==void 0?w[1]:{},n=e.open,r=n===void 0||n,o=e.startMeasurements,l=o===void 0||o,(u=t).godirectAdapter||(u=new Pe(t)),f=new Le(u),!r){g.next=14;break}return g.prev=5,g.next=8,f.open(l);case 8:g.next=14;break;case 10:throw g.prev=10,g.t0=g.catch(5),I.error(g.t0),g.t0;case 14:return g.abrupt("return",f);case 15:case"end":return g.stop()}},i,this,[[5,10]])}));return function(i){return h.apply(this,arguments)}}(),selectDevice:function(){var h=d(regeneratorRuntime.mark(function i(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.bluetooth){e.next=2;break}return e.abrupt("return",Promise.reject(new Error("No Web Bluetooth support.")));case 2:return e.next=4,navigator.bluetooth.requestDevice({filters:[{namePrefix:"GDX"}],optionalServices:["d91714ef-28b9-4f91-ba16-f0d9a604f112"]});case 4:return t=e.sent,e.abrupt("return",ue.createDevice(t));case 6:case"end":return e.stop()}},i,this)}));return function(){return h.apply(this,arguments)}}()};return ue})}}]);
