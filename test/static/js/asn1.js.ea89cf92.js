"use strict";(self.webpackChunk_lls_web_app=self.webpackChunk_lls_web_app||[]).push([[6671],{22812:(S,b,h)=>{const m=b;m.bignum=h(62197),m.define=h(45192).define,m.base=h(84798),m.constants=h(96906),m.decoders=h(18211),m.encoders=h(89116)},45192:(S,b,h)=>{const m=h(89116),p=h(18211),g=h(91285),a=b;a.define=function(s,l){return new f(s,l)};function f(c,s){this.name=c,this.body=s,this.decoders={},this.encoders={}}f.prototype._createNamed=function(s){const l=this.name;function d(o){this._initNamed(o,l)}return g(d,s),d.prototype._initNamed=function(e,r){s.call(this,e,r)},new d(this)},f.prototype._getDecoder=function(s){return s=s||"der",this.decoders.hasOwnProperty(s)||(this.decoders[s]=this._createNamed(p[s])),this.decoders[s]},f.prototype.decode=function(s,l,d){return this._getDecoder(l).decode(s,d)},f.prototype._getEncoder=function(s){return s=s||"der",this.encoders.hasOwnProperty(s)||(this.encoders[s]=this._createNamed(m[s])),this.encoders[s]},f.prototype.encode=function(s,l,d){return this._getEncoder(l).encode(s,d)}},47362:(S,b,h)=>{const m=h(91285),p=h(80126).b,g=h(27654).Buffer;function a(c,s){if(p.call(this,s),!g.isBuffer(c)){this.error("Input not Buffer");return}this.base=c,this.offset=0,this.length=c.length}m(a,p),b.C=a,a.isDecoderBuffer=function(s){return s instanceof a?!0:typeof s=="object"&&g.isBuffer(s.base)&&s.constructor.name==="DecoderBuffer"&&typeof s.offset=="number"&&typeof s.length=="number"&&typeof s.save=="function"&&typeof s.restore=="function"&&typeof s.isEmpty=="function"&&typeof s.readUInt8=="function"&&typeof s.skip=="function"&&typeof s.raw=="function"},a.prototype.save=function(){return{offset:this.offset,reporter:p.prototype.save.call(this)}},a.prototype.restore=function(s){const l=new a(this.base);return l.offset=s.offset,l.length=this.offset,this.offset=s.offset,p.prototype.restore.call(this,s.reporter),l},a.prototype.isEmpty=function(){return this.offset===this.length},a.prototype.readUInt8=function(s){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(s||"DecoderBuffer overrun")},a.prototype.skip=function(s,l){if(!(this.offset+s<=this.length))return this.error(l||"DecoderBuffer overrun");const d=new a(this.base);return d._reporterState=this._reporterState,d.offset=this.offset,d.length=this.offset+s,this.offset+=s,d},a.prototype.raw=function(s){return this.base.slice(s?s.offset:this.offset,this.length)};function f(c,s){if(Array.isArray(c))this.length=0,this.value=c.map(function(l){return f.isEncoderBuffer(l)||(l=new f(l,s)),this.length+=l.length,l},this);else if(typeof c=="number"){if(!(0<=c&&c<=255))return s.error("non-byte EncoderBuffer value");this.value=c,this.length=1}else if(typeof c=="string")this.value=c,this.length=g.byteLength(c);else if(g.isBuffer(c))this.value=c,this.length=c.length;else return s.error("Unsupported type: "+typeof c)}b.R=f,f.isEncoderBuffer=function(s){return s instanceof f?!0:typeof s=="object"&&s.constructor.name==="EncoderBuffer"&&typeof s.length=="number"&&typeof s.join=="function"},f.prototype.join=function(s,l){return s||(s=g.alloc(this.length)),l||(l=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(d){d.join(s,l),l+=d.length}):(typeof this.value=="number"?s[l]=this.value:typeof this.value=="string"?s.write(this.value,l):g.isBuffer(this.value)&&this.value.copy(s,l),l+=this.length)),s}},84798:(S,b,h)=>{const m=b;m.Reporter=h(80126).b,m.DecoderBuffer=h(47362).C,m.EncoderBuffer=h(47362).R,m.Node=h(80847)},80847:(S,b,h)=>{const m=h(80126).b,p=h(47362).R,g=h(47362).C,a=h(79561),f=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],c=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(f),s=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function l(o,e,r){const t={};this._baseState=t,t.name=r,t.enc=o,t.parent=e||null,t.children=null,t.tag=null,t.args=null,t.reverseArgs=null,t.choice=null,t.optional=!1,t.any=!1,t.obj=!1,t.use=null,t.useDecoder=null,t.key=null,t.default=null,t.explicit=null,t.implicit=null,t.contains=null,t.parent||(t.children=[],this._wrap())}S.exports=l;const d=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];l.prototype.clone=function(){const e=this._baseState,r={};d.forEach(function(n){r[n]=e[n]});const t=new this.constructor(r.parent);return t._baseState=r,t},l.prototype._wrap=function(){const e=this._baseState;c.forEach(function(r){this[r]=function(){const n=new this.constructor(this);return e.children.push(n),n[r].apply(n,arguments)}},this)},l.prototype._init=function(e){const r=this._baseState;a(r.parent===null),e.call(this),r.children=r.children.filter(function(t){return t._baseState.parent===this},this),a.equal(r.children.length,1,"Root node can have only one child")},l.prototype._useArgs=function(e){const r=this._baseState,t=e.filter(function(n){return n instanceof this.constructor},this);e=e.filter(function(n){return!(n instanceof this.constructor)},this),t.length!==0&&(a(r.children===null),r.children=t,t.forEach(function(n){n._baseState.parent=this},this)),e.length!==0&&(a(r.args===null),r.args=e,r.reverseArgs=e.map(function(n){if(typeof n!="object"||n.constructor!==Object)return n;const i={};return Object.keys(n).forEach(function(u){u==(u|0)&&(u|=0);const y=n[u];i[y]=u}),i}))},s.forEach(function(o){l.prototype[o]=function(){const r=this._baseState;throw new Error(o+" not implemented for encoding: "+r.enc)}}),f.forEach(function(o){l.prototype[o]=function(){const r=this._baseState,t=Array.prototype.slice.call(arguments);return a(r.tag===null),r.tag=o,this._useArgs(t),this}}),l.prototype.use=function(e){a(e);const r=this._baseState;return a(r.use===null),r.use=e,this},l.prototype.optional=function(){const e=this._baseState;return e.optional=!0,this},l.prototype.def=function(e){const r=this._baseState;return a(r.default===null),r.default=e,r.optional=!0,this},l.prototype.explicit=function(e){const r=this._baseState;return a(r.explicit===null&&r.implicit===null),r.explicit=e,this},l.prototype.implicit=function(e){const r=this._baseState;return a(r.explicit===null&&r.implicit===null),r.implicit=e,this},l.prototype.obj=function(){const e=this._baseState,r=Array.prototype.slice.call(arguments);return e.obj=!0,r.length!==0&&this._useArgs(r),this},l.prototype.key=function(e){const r=this._baseState;return a(r.key===null),r.key=e,this},l.prototype.any=function(){const e=this._baseState;return e.any=!0,this},l.prototype.choice=function(e){const r=this._baseState;return a(r.choice===null),r.choice=e,this._useArgs(Object.keys(e).map(function(t){return e[t]})),this},l.prototype.contains=function(e){const r=this._baseState;return a(r.use===null),r.contains=e,this},l.prototype._decode=function(e,r){const t=this._baseState;if(t.parent===null)return e.wrapResult(t.children[0]._decode(e,r));let n=t.default,i=!0,u=null;if(t.key!==null&&(u=e.enterKey(t.key)),t.optional){let _=null;if(t.explicit!==null?_=t.explicit:t.implicit!==null?_=t.implicit:t.tag!==null&&(_=t.tag),_===null&&!t.any){const E=e.save();try{t.choice===null?this._decodeGeneric(t.tag,e,r):this._decodeChoice(e,r),i=!0}catch(x){i=!1}e.restore(E)}else if(i=this._peekTag(e,_,t.any),e.isError(i))return i}let y;if(t.obj&&i&&(y=e.enterObject()),i){if(t.explicit!==null){const E=this._decodeTag(e,t.explicit);if(e.isError(E))return E;e=E}const _=e.offset;if(t.use===null&&t.choice===null){let E;t.any&&(E=e.save());const x=this._decodeTag(e,t.implicit!==null?t.implicit:t.tag,t.any);if(e.isError(x))return x;t.any?n=e.raw(E):e=x}if(r&&r.track&&t.tag!==null&&r.track(e.path(),_,e.length,"tagged"),r&&r.track&&t.tag!==null&&r.track(e.path(),e.offset,e.length,"content"),t.any||(t.choice===null?n=this._decodeGeneric(t.tag,e,r):n=this._decodeChoice(e,r)),e.isError(n))return n;if(!t.any&&t.choice===null&&t.children!==null&&t.children.forEach(function(x){x._decode(e,r)}),t.contains&&(t.tag==="octstr"||t.tag==="bitstr")){const E=new g(n);n=this._getUse(t.contains,e._reporterState.obj)._decode(E,r)}}return t.obj&&i&&(n=e.leaveObject(y)),t.key!==null&&(n!==null||i===!0)?e.leaveKey(u,t.key,n):u!==null&&e.exitKey(u),n},l.prototype._decodeGeneric=function(e,r,t){const n=this._baseState;return e==="seq"||e==="set"?null:e==="seqof"||e==="setof"?this._decodeList(r,e,n.args[0],t):/str$/.test(e)?this._decodeStr(r,e,t):e==="objid"&&n.args?this._decodeObjid(r,n.args[0],n.args[1],t):e==="objid"?this._decodeObjid(r,null,null,t):e==="gentime"||e==="utctime"?this._decodeTime(r,e,t):e==="null_"?this._decodeNull(r,t):e==="bool"?this._decodeBool(r,t):e==="objDesc"?this._decodeStr(r,e,t):e==="int"||e==="enum"?this._decodeInt(r,n.args&&n.args[0],t):n.use!==null?this._getUse(n.use,r._reporterState.obj)._decode(r,t):r.error("unknown tag: "+e)},l.prototype._getUse=function(e,r){const t=this._baseState;return t.useDecoder=this._use(e,r),a(t.useDecoder._baseState.parent===null),t.useDecoder=t.useDecoder._baseState.children[0],t.implicit!==t.useDecoder._baseState.implicit&&(t.useDecoder=t.useDecoder.clone(),t.useDecoder._baseState.implicit=t.implicit),t.useDecoder},l.prototype._decodeChoice=function(e,r){const t=this._baseState;let n=null,i=!1;return Object.keys(t.choice).some(function(u){const y=e.save(),_=t.choice[u];try{const E=_._decode(e,r);if(e.isError(E))return!1;n={type:u,value:E},i=!0}catch(E){return e.restore(y),!1}return!0},this),i?n:e.error("Choice not matched")},l.prototype._createEncoderBuffer=function(e){return new p(e,this.reporter)},l.prototype._encode=function(e,r,t){const n=this._baseState;if(n.default!==null&&n.default===e)return;const i=this._encodeValue(e,r,t);if(i!==void 0&&!this._skipDefault(i,r,t))return i},l.prototype._encodeValue=function(e,r,t){const n=this._baseState;if(n.parent===null)return n.children[0]._encode(e,r||new m);let i=null;if(this.reporter=r,n.optional&&e===void 0)if(n.default!==null)e=n.default;else return;let u=null,y=!1;if(n.any)i=this._createEncoderBuffer(e);else if(n.choice)i=this._encodeChoice(e,r);else if(n.contains)u=this._getUse(n.contains,t)._encode(e,r),y=!0;else if(n.children)u=n.children.map(function(_){if(_._baseState.tag==="null_")return _._encode(null,r,e);if(_._baseState.key===null)return r.error("Child should have a key");const E=r.enterKey(_._baseState.key);if(typeof e!="object")return r.error("Child expected, but input is not object");const x=_._encode(e[_._baseState.key],r,e);return r.leaveKey(E),x},this).filter(function(_){return _}),u=this._createEncoderBuffer(u);else if(n.tag==="seqof"||n.tag==="setof"){if(!(n.args&&n.args.length===1))return r.error("Too many args for : "+n.tag);if(!Array.isArray(e))return r.error("seqof/setof, but data is not Array");const _=this.clone();_._baseState.implicit=null,u=this._createEncoderBuffer(e.map(function(E){const x=this._baseState;return this._getUse(x.args[0],e)._encode(E,r)},_))}else n.use!==null?i=this._getUse(n.use,t)._encode(e,r):(u=this._encodePrimitive(n.tag,e),y=!0);if(!n.any&&n.choice===null){const _=n.implicit!==null?n.implicit:n.tag,E=n.implicit===null?"universal":"context";_===null?n.use===null&&r.error("Tag could be omitted only for .use()"):n.use===null&&(i=this._encodeComposite(_,y,E,u))}return n.explicit!==null&&(i=this._encodeComposite(n.explicit,!1,"context",i)),i},l.prototype._encodeChoice=function(e,r){const t=this._baseState,n=t.choice[e.type];return n||a(!1,e.type+" not found in "+JSON.stringify(Object.keys(t.choice))),n._encode(e.value,r)},l.prototype._encodePrimitive=function(e,r){const t=this._baseState;if(/str$/.test(e))return this._encodeStr(r,e);if(e==="objid"&&t.args)return this._encodeObjid(r,t.reverseArgs[0],t.args[1]);if(e==="objid")return this._encodeObjid(r,null,null);if(e==="gentime"||e==="utctime")return this._encodeTime(r,e);if(e==="null_")return this._encodeNull();if(e==="int"||e==="enum")return this._encodeInt(r,t.args&&t.reverseArgs[0]);if(e==="bool")return this._encodeBool(r);if(e==="objDesc")return this._encodeStr(r,e);throw new Error("Unsupported tag: "+e)},l.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},l.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)}},80126:(S,b,h)=>{const m=h(91285);function p(a){this._reporterState={obj:null,path:[],options:a||{},errors:[]}}b.b=p,p.prototype.isError=function(f){return f instanceof g},p.prototype.save=function(){const f=this._reporterState;return{obj:f.obj,pathLen:f.path.length}},p.prototype.restore=function(f){const c=this._reporterState;c.obj=f.obj,c.path=c.path.slice(0,f.pathLen)},p.prototype.enterKey=function(f){return this._reporterState.path.push(f)},p.prototype.exitKey=function(f){const c=this._reporterState;c.path=c.path.slice(0,f-1)},p.prototype.leaveKey=function(f,c,s){const l=this._reporterState;this.exitKey(f),l.obj!==null&&(l.obj[c]=s)},p.prototype.path=function(){return this._reporterState.path.join("/")},p.prototype.enterObject=function(){const f=this._reporterState,c=f.obj;return f.obj={},c},p.prototype.leaveObject=function(f){const c=this._reporterState,s=c.obj;return c.obj=f,s},p.prototype.error=function(f){let c;const s=this._reporterState,l=f instanceof g;if(l?c=f:c=new g(s.path.map(function(d){return"["+JSON.stringify(d)+"]"}).join(""),f.message||f,f.stack),!s.options.partial)throw c;return l||s.errors.push(c),c},p.prototype.wrapResult=function(f){const c=this._reporterState;return c.options.partial?{result:this.isError(f)?null:f,errors:c.errors}:f};function g(a,f){this.path=a,this.rethrow(f)}m(g,Error),g.prototype.rethrow=function(f){if(this.message=f+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,g),!this.stack)try{throw new Error(this.message)}catch(c){this.stack=c.stack}return this}},4131:(S,b)=>{function h(m){const p={};return Object.keys(m).forEach(function(g){(g|0)==g&&(g=g|0);const a=m[g];p[a]=g}),p}b.tagClass={0:"universal",1:"application",2:"context",3:"private"},b.tagClassByName=h(b.tagClass),b.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},b.tagByName=h(b.tag)},96906:(S,b,h)=>{const m=b;m._reverse=function(g){const a={};return Object.keys(g).forEach(function(f){(f|0)==f&&(f=f|0);const c=g[f];a[c]=f}),a},m.der=h(4131)},41066:(S,b,h)=>{const m=h(91285),p=h(62197),g=h(47362).C,a=h(80847),f=h(4131);function c(o){this.enc="der",this.name=o.name,this.entity=o,this.tree=new s,this.tree._init(o.body)}S.exports=c,c.prototype.decode=function(e,r){return g.isDecoderBuffer(e)||(e=new g(e,r)),this.tree._decode(e,r)};function s(o){a.call(this,"der",o)}m(s,a),s.prototype._peekTag=function(e,r,t){if(e.isEmpty())return!1;const n=e.save(),i=l(e,'Failed to peek tag: "'+r+'"');return e.isError(i)?i:(e.restore(n),i.tag===r||i.tagStr===r||i.tagStr+"of"===r||t)},s.prototype._decodeTag=function(e,r,t){const n=l(e,'Failed to decode tag of "'+r+'"');if(e.isError(n))return n;let i=d(e,n.primitive,'Failed to get length of "'+r+'"');if(e.isError(i))return i;if(!t&&n.tag!==r&&n.tagStr!==r&&n.tagStr+"of"!==r)return e.error('Failed to match tag: "'+r+'"');if(n.primitive||i!==null)return e.skip(i,'Failed to match body of: "'+r+'"');const u=e.save(),y=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(y)?y:(i=e.offset-u.offset,e.restore(u),e.skip(i,'Failed to match body of: "'+r+'"'))},s.prototype._skipUntilEnd=function(e,r){for(;;){const t=l(e,r);if(e.isError(t))return t;const n=d(e,t.primitive,r);if(e.isError(n))return n;let i;if(t.primitive||n!==null?i=e.skip(n):i=this._skipUntilEnd(e,r),e.isError(i))return i;if(t.tagStr==="end")break}},s.prototype._decodeList=function(e,r,t,n){const i=[];for(;!e.isEmpty();){const u=this._peekTag(e,"end");if(e.isError(u))return u;const y=t.decode(e,"der",n);if(e.isError(y)&&u)break;i.push(y)}return i},s.prototype._decodeStr=function(e,r){if(r==="bitstr"){const t=e.readUInt8();return e.isError(t)?t:{unused:t,data:e.raw()}}else if(r==="bmpstr"){const t=e.raw();if(t.length%2===1)return e.error("Decoding of string type: bmpstr length mismatch");let n="";for(let i=0;i<t.length/2;i++)n+=String.fromCharCode(t.readUInt16BE(i*2));return n}else if(r==="numstr"){const t=e.raw().toString("ascii");return this._isNumstr(t)?t:e.error("Decoding of string type: numstr unsupported characters")}else{if(r==="octstr")return e.raw();if(r==="objDesc")return e.raw();if(r==="printstr"){const t=e.raw().toString("ascii");return this._isPrintstr(t)?t:e.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(r)?e.raw().toString():e.error("Decoding of string type: "+r+" unsupported")}},s.prototype._decodeObjid=function(e,r,t){let n;const i=[];let u=0,y=0;for(;!e.isEmpty();)y=e.readUInt8(),u<<=7,u|=y&127,(y&128)===0&&(i.push(u),u=0);y&128&&i.push(u);const _=i[0]/40|0,E=i[0]%40;if(t?n=i:n=[_,E].concat(i.slice(1)),r){let x=r[n.join(" ")];x===void 0&&(x=r[n.join(".")]),x!==void 0&&(n=x)}return n},s.prototype._decodeTime=function(e,r){const t=e.raw().toString();let n,i,u,y,_,E;if(r==="gentime")n=t.slice(0,4)|0,i=t.slice(4,6)|0,u=t.slice(6,8)|0,y=t.slice(8,10)|0,_=t.slice(10,12)|0,E=t.slice(12,14)|0;else if(r==="utctime")n=t.slice(0,2)|0,i=t.slice(2,4)|0,u=t.slice(4,6)|0,y=t.slice(6,8)|0,_=t.slice(8,10)|0,E=t.slice(10,12)|0,n<70?n=2e3+n:n=1900+n;else return e.error("Decoding "+r+" time is not supported yet");return Date.UTC(n,i-1,u,y,_,E,0)},s.prototype._decodeNull=function(){return null},s.prototype._decodeBool=function(e){const r=e.readUInt8();return e.isError(r)?r:r!==0},s.prototype._decodeInt=function(e,r){const t=e.raw();let n=new p(t);return r&&(n=r[n.toString(10)]||n),n},s.prototype._use=function(e,r){return typeof e=="function"&&(e=e(r)),e._getDecoder("der").tree};function l(o,e){let r=o.readUInt8(e);if(o.isError(r))return r;const t=f.tagClass[r>>6],n=(r&32)===0;if((r&31)===31){let u=r;for(r=0;(u&128)===128;){if(u=o.readUInt8(e),o.isError(u))return u;r<<=7,r|=u&127}}else r&=31;const i=f.tag[r];return{cls:t,primitive:n,tag:r,tagStr:i}}function d(o,e,r){let t=o.readUInt8(r);if(o.isError(t))return t;if(!e&&t===128)return null;if((t&128)===0)return t;const n=t&127;if(n>4)return o.error("length octect is too long");t=0;for(let i=0;i<n;i++){t<<=8;const u=o.readUInt8(r);if(o.isError(u))return u;t|=u}return t}},18211:(S,b,h)=>{const m=b;m.der=h(41066),m.pem=h(63956)},63956:(S,b,h)=>{const m=h(91285),p=h(27654).Buffer,g=h(41066);function a(f){g.call(this,f),this.enc="pem"}m(a,g),S.exports=a,a.prototype.decode=function(c,s){const l=c.toString().split(/[\r\n]+/g),d=s.label.toUpperCase(),o=/^-----(BEGIN|END) ([^-]+)-----$/;let e=-1,r=-1;for(let i=0;i<l.length;i++){const u=l[i].match(o);if(u!==null&&u[2]===d)if(e===-1){if(u[1]!=="BEGIN")break;e=i}else{if(u[1]!=="END")break;r=i;break}}if(e===-1||r===-1)throw new Error("PEM section not found for: "+d);const t=l.slice(e+1,r).join("");t.replace(/[^a-z0-9+/=]+/gi,"");const n=p.from(t,"base64");return g.prototype.decode.call(this,n,s)}},95758:(S,b,h)=>{const m=h(91285),p=h(27654).Buffer,g=h(80847),a=h(4131);function f(d){this.enc="der",this.name=d.name,this.entity=d,this.tree=new c,this.tree._init(d.body)}S.exports=f,f.prototype.encode=function(o,e){return this.tree._encode(o,e).join()};function c(d){g.call(this,"der",d)}m(c,g),c.prototype._encodeComposite=function(o,e,r,t){const n=l(o,e,r,this.reporter);if(t.length<128){const y=p.alloc(2);return y[0]=n,y[1]=t.length,this._createEncoderBuffer([y,t])}let i=1;for(let y=t.length;y>=256;y>>=8)i++;const u=p.alloc(1+1+i);u[0]=n,u[1]=128|i;for(let y=1+i,_=t.length;_>0;y--,_>>=8)u[y]=_&255;return this._createEncoderBuffer([u,t])},c.prototype._encodeStr=function(o,e){if(e==="bitstr")return this._createEncoderBuffer([o.unused|0,o.data]);if(e==="bmpstr"){const r=p.alloc(o.length*2);for(let t=0;t<o.length;t++)r.writeUInt16BE(o.charCodeAt(t),t*2);return this._createEncoderBuffer(r)}else return e==="numstr"?this._isNumstr(o)?this._createEncoderBuffer(o):this.reporter.error("Encoding of string type: numstr supports only digits and space"):e==="printstr"?this._isPrintstr(o)?this._createEncoderBuffer(o):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(e)?this._createEncoderBuffer(o):e==="objDesc"?this._createEncoderBuffer(o):this.reporter.error("Encoding of string type: "+e+" unsupported")},c.prototype._encodeObjid=function(o,e,r){if(typeof o=="string"){if(!e)return this.reporter.error("string objid given, but no values map found");if(!e.hasOwnProperty(o))return this.reporter.error("objid not found in values map");o=e[o].split(/[\s.]+/g);for(let u=0;u<o.length;u++)o[u]|=0}else if(Array.isArray(o)){o=o.slice();for(let u=0;u<o.length;u++)o[u]|=0}if(!Array.isArray(o))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(o));if(!r){if(o[1]>=40)return this.reporter.error("Second objid identifier OOB");o.splice(0,2,o[0]*40+o[1])}let t=0;for(let u=0;u<o.length;u++){let y=o[u];for(t++;y>=128;y>>=7)t++}const n=p.alloc(t);let i=n.length-1;for(let u=o.length-1;u>=0;u--){let y=o[u];for(n[i--]=y&127;(y>>=7)>0;)n[i--]=128|y&127}return this._createEncoderBuffer(n)};function s(d){return d<10?"0"+d:d}c.prototype._encodeTime=function(o,e){let r;const t=new Date(o);return e==="gentime"?r=[s(t.getUTCFullYear()),s(t.getUTCMonth()+1),s(t.getUTCDate()),s(t.getUTCHours()),s(t.getUTCMinutes()),s(t.getUTCSeconds()),"Z"].join(""):e==="utctime"?r=[s(t.getUTCFullYear()%100),s(t.getUTCMonth()+1),s(t.getUTCDate()),s(t.getUTCHours()),s(t.getUTCMinutes()),s(t.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+e+" time is not supported yet"),this._encodeStr(r,"octstr")},c.prototype._encodeNull=function(){return this._createEncoderBuffer("")},c.prototype._encodeInt=function(o,e){if(typeof o=="string"){if(!e)return this.reporter.error("String int or enum given, but no values map");if(!e.hasOwnProperty(o))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(o));o=e[o]}if(typeof o!="number"&&!p.isBuffer(o)){const n=o.toArray();!o.sign&&n[0]&128&&n.unshift(0),o=p.from(n)}if(p.isBuffer(o)){let n=o.length;o.length===0&&n++;const i=p.alloc(n);return o.copy(i),o.length===0&&(i[0]=0),this._createEncoderBuffer(i)}if(o<128)return this._createEncoderBuffer(o);if(o<256)return this._createEncoderBuffer([0,o]);let r=1;for(let n=o;n>=256;n>>=8)r++;const t=new Array(r);for(let n=t.length-1;n>=0;n--)t[n]=o&255,o>>=8;return t[0]&128&&t.unshift(0),this._createEncoderBuffer(p.from(t))},c.prototype._encodeBool=function(o){return this._createEncoderBuffer(o?255:0)},c.prototype._use=function(o,e){return typeof o=="function"&&(o=o(e)),o._getEncoder("der").tree},c.prototype._skipDefault=function(o,e,r){const t=this._baseState;let n;if(t.default===null)return!1;const i=o.join();if(t.defaultBuffer===void 0&&(t.defaultBuffer=this._encodeValue(t.default,e,r).join()),i.length!==t.defaultBuffer.length)return!1;for(n=0;n<i.length;n++)if(i[n]!==t.defaultBuffer[n])return!1;return!0};function l(d,o,e,r){let t;if(d==="seqof"?d="seq":d==="setof"&&(d="set"),a.tagByName.hasOwnProperty(d))t=a.tagByName[d];else if(typeof d=="number"&&(d|0)===d)t=d;else return r.error("Unknown tag: "+d);return t>=31?r.error("Multi-octet tag encoding unsupported"):(o||(t|=32),t|=a.tagClassByName[e||"universal"]<<6,t)}},89116:(S,b,h)=>{const m=b;m.der=h(95758),m.pem=h(99245)},99245:(S,b,h)=>{const m=h(91285),p=h(95758);function g(a){p.call(this,a),this.enc="pem"}m(g,p),S.exports=g,g.prototype.encode=function(f,c){const l=p.prototype.encode.call(this,f).toString("base64"),d=["-----BEGIN "+c.label+"-----"];for(let o=0;o<l.length;o+=64)d.push(l.slice(o,o+64));return d.push("-----END "+c.label+"-----"),d.join(`
`)}}}]);
